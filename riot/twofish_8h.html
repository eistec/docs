<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>twofish.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="riot-logo.svg"/></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">The friendly Operating System for the Internet of Things</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('twofish_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a>  </div>
  <div class="headertitle">
<div class="title">twofish.h File Reference<div class="ingroups"><a class="el" href="group__sys.html">System</a> &raquo; <a class="el" href="group__sys__crypto.html">Crypto</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Headers for the implementation of the TwoFish Cipher-Algorithm.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdarg.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;<a class="el" href="ciphers_8h_source.html">crypto/ciphers.h</a>&quot;</code><br />
</div>
<p><a href="twofish_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtwofish__context__t.html">twofish_context_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure for an expanded Twofish key.  <a href="structtwofish__context__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55d610adc6428db72c923b2e4f4df10b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a55d610adc6428db72c923b2e4f4df10b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TWOFISH_BLOCK_SIZE</b>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a55d610adc6428db72c923b2e4f4df10b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c9d3c39186a95e044608800f51e4865"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7c9d3c39186a95e044608800f51e4865"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TWOFISH_KEY_SIZE</b>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a7c9d3c39186a95e044608800f51e4865"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8439fabb9ffa1a5aa17e17ae79aaab4b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8h.html#a8439fabb9ffa1a5aa17e17ae79aaab4b">CALC_S</a>(a, b, c, d, i, w, x, y, z)</td></tr>
<tr class="memdesc:a8439fabb9ffa1a5aa17e17ae79aaab4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Macro to perform one column of the RS matrix multiplication.  <a href="#a8439fabb9ffa1a5aa17e17ae79aaab4b">More...</a><br /></td></tr>
<tr class="separator:a8439fabb9ffa1a5aa17e17ae79aaab4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd680b624c9e24336e9608b967262c3a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8h.html#acd680b624c9e24336e9608b967262c3a">CALC_SB_2</a>(i, a, b)</td></tr>
<tr class="memdesc:acd680b624c9e24336e9608b967262c3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Macros to calculate the key-dependent S-boxes for a 128-bit key using the S vector from CALC_S.  <a href="#acd680b624c9e24336e9608b967262c3a">More...</a><br /></td></tr>
<tr class="separator:acd680b624c9e24336e9608b967262c3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a373ae1e6d38bd37b09ed2b1de8b62a32"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>CALC_SB</b>(i, a, b, c, d, e, f, g, h)</td></tr>
<tr class="separator:a373ae1e6d38bd37b09ed2b1de8b62a32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae06b16211a5d7740c0b6a5988f904cc8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>CALC_SB256_2</b>(i, a, b)</td></tr>
<tr class="separator:ae06b16211a5d7740c0b6a5988f904cc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a503d9bac2e6ebe306bfc4035c0c6a068"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>CALC_SB256</b>(i, a, b, c, d, e, f, g, h)</td></tr>
<tr class="separator:a503d9bac2e6ebe306bfc4035c0c6a068"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc41493ff1b2d5f18d1b44731f44b58c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8h.html#afc41493ff1b2d5f18d1b44731f44b58c">CALC_K_2</a>(a, b, c, d, j)</td></tr>
<tr class="memdesc:afc41493ff1b2d5f18d1b44731f44b58c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Macros to calculate the whitening and round subkeys.  <a href="#afc41493ff1b2d5f18d1b44731f44b58c">More...</a><br /></td></tr>
<tr class="separator:afc41493ff1b2d5f18d1b44731f44b58c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae58f426f79b636ded23a6aa6c6ead7b4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>CALC_K</b>(a, j, k, l, m, n)</td></tr>
<tr class="separator:ae58f426f79b636ded23a6aa6c6ead7b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84ffcf7d66e0b52b79790e3af4636fe6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>CALC_K256_2</b>(a, b, j)</td></tr>
<tr class="separator:a84ffcf7d66e0b52b79790e3af4636fe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e5982ec95cef59b942c7acb8ff12c78"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>CALC_K256</b>(a, j, k, l, m, n)</td></tr>
<tr class="separator:a3e5982ec95cef59b942c7acb8ff12c78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0884cc2284e58fab5c6e73806c8a6147"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8h.html#a0884cc2284e58fab5c6e73806c8a6147">G1</a>(a)</td></tr>
<tr class="memdesc:a0884cc2284e58fab5c6e73806c8a6147"><td class="mdescLeft">&#160;</td><td class="mdescRight">Macros to compute the g() function in the encryption and decryption rounds.  <a href="#a0884cc2284e58fab5c6e73806c8a6147">More...</a><br /></td></tr>
<tr class="separator:a0884cc2284e58fab5c6e73806c8a6147"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac979a22b5b6d21e4381d4f11f26cd802"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>G2</b>(b)</td></tr>
<tr class="separator:ac979a22b5b6d21e4381d4f11f26cd802"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab251af32ba2ecb69651d92289ddf87a5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8h.html#ab251af32ba2ecb69651d92289ddf87a5">ENCROUND</a>(n, a, b, c, d)</td></tr>
<tr class="memdesc:ab251af32ba2ecb69651d92289ddf87a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encryption and decryption Feistel rounds.  <a href="#ab251af32ba2ecb69651d92289ddf87a5">More...</a><br /></td></tr>
<tr class="separator:ab251af32ba2ecb69651d92289ddf87a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d7b116cbab2aa704d90edbebc826520"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>DECROUND</b>(n, a, b, c, d)</td></tr>
<tr class="separator:a7d7b116cbab2aa704d90edbebc826520"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05f7f296ae94465e73ebecc964f4b70b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8h.html#a05f7f296ae94465e73ebecc964f4b70b">ENCCYCLE</a>(n)</td></tr>
<tr class="memdesc:a05f7f296ae94465e73ebecc964f4b70b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encryption and decryption cycles; each one is simply two Feistel rounds with the 32-bit chunks re-ordered to simulate the "swap".  <a href="#a05f7f296ae94465e73ebecc964f4b70b">More...</a><br /></td></tr>
<tr class="separator:a05f7f296ae94465e73ebecc964f4b70b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ec9a4d3e5e0feea19dea102bb028d78"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>DECCYCLE</b>(n)</td></tr>
<tr class="separator:a5ec9a4d3e5e0feea19dea102bb028d78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a007b60ee9e74f0890abed257d6f8d58d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8h.html#a007b60ee9e74f0890abed257d6f8d58d">INPACK</a>(n, x, m)</td></tr>
<tr class="memdesc:a007b60ee9e74f0890abed257d6f8d58d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Macros to convert the input and output bytes into 32-bit words, and simultaneously perform the whitening step.  <a href="#a007b60ee9e74f0890abed257d6f8d58d">More...</a><br /></td></tr>
<tr class="separator:a007b60ee9e74f0890abed257d6f8d58d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3b514d7f0f2d9f0827463eb3de1f798"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>OUTUNPACK</b>(n, x, m)</td></tr>
<tr class="separator:ad3b514d7f0f2d9f0827463eb3de1f798"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a664bfa54e2065ef08486b44f38ca969a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structblock__cipher__interface__t.html">block_cipher_interface_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8h.html#a664bfa54e2065ef08486b44f38ca969a">twofish_interface</a></td></tr>
<tr class="memdesc:a664bfa54e2065ef08486b44f38ca969a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface to access the functions.  <a href="#a664bfa54e2065ef08486b44f38ca969a">More...</a><br /></td></tr>
<tr class="separator:a664bfa54e2065ef08486b44f38ca969a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c4b7e3782e3adfcfcdca08d258f7967"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8h.html#a9c4b7e3782e3adfcfcdca08d258f7967">twofish_init</a> (<a class="el" href="structcipher__context__t.html">cipher_context_t</a> *context, uint8_t block_size, uint8_t key_size, uint8_t *key)</td></tr>
<tr class="memdesc:a9c4b7e3782e3adfcfcdca08d258f7967"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the TwoFish-BlockCipher context.  <a href="#a9c4b7e3782e3adfcfcdca08d258f7967">More...</a><br /></td></tr>
<tr class="separator:a9c4b7e3782e3adfcfcdca08d258f7967"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9affa50785ecaa0cef11bf9c2c065d67"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8h.html#a9affa50785ecaa0cef11bf9c2c065d67">twofish_setup_key</a> (<a class="el" href="structcipher__context__t.html">cipher_context_t</a> *context, uint8_t *key, uint8_t key_size)</td></tr>
<tr class="memdesc:a9affa50785ecaa0cef11bf9c2c065d67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the context to use the passed key for usage with TwoFish Performs the key expansion on the real secret.  <a href="#a9affa50785ecaa0cef11bf9c2c065d67">More...</a><br /></td></tr>
<tr class="separator:a9affa50785ecaa0cef11bf9c2c065d67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7459418164d80fb13f214b7ed942bc11"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8h.html#a7459418164d80fb13f214b7ed942bc11">twofish_encrypt</a> (<a class="el" href="structcipher__context__t.html">cipher_context_t</a> *context, uint8_t *in, uint8_t *out)</td></tr>
<tr class="memdesc:a7459418164d80fb13f214b7ed942bc11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts a single block (of blockSize) using the passed context.  <a href="#a7459418164d80fb13f214b7ed942bc11">More...</a><br /></td></tr>
<tr class="separator:a7459418164d80fb13f214b7ed942bc11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa50b10ac974d8cd60dc30db4657e52f0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8h.html#aa50b10ac974d8cd60dc30db4657e52f0">twofish_decrypt</a> (<a class="el" href="structcipher__context__t.html">cipher_context_t</a> *context, uint8_t *in, uint8_t *out)</td></tr>
<tr class="memdesc:aa50b10ac974d8cd60dc30db4657e52f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts a single block (of blockSize) using the passed context.  <a href="#aa50b10ac974d8cd60dc30db4657e52f0">More...</a><br /></td></tr>
<tr class="separator:aa50b10ac974d8cd60dc30db4657e52f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ede87c36bc6c9563a83e2f003c98325"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8h.html#a4ede87c36bc6c9563a83e2f003c98325">twofish_get_preferred_block_size</a> (void)</td></tr>
<tr class="memdesc:a4ede87c36bc6c9563a83e2f003c98325"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the preferred block size that this cipher operates with.  <a href="#a4ede87c36bc6c9563a83e2f003c98325">More...</a><br /></td></tr>
<tr class="separator:a4ede87c36bc6c9563a83e2f003c98325"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Headers for the implementation of the TwoFish Cipher-Algorithm. </p>
<dl class="section author"><dt>Author</dt><dd>Freie Universitaet Berlin, Computer Systems &amp; Telematics </dd>
<dd>
Nicolai Schmittberger <a href="#" onclick="location.href='mai'+'lto:'+'nic'+'ol'+'ai.'+'sc'+'hmi'+'tt'+'ber'+'ge'+'r@f'+'u-'+'ber'+'li'+'n.d'+'e'; return false;">nicol<span style="display: none;">.nosp@m.</span>ai.s<span style="display: none;">.nosp@m.</span>chmit<span style="display: none;">.nosp@m.</span>tber<span style="display: none;">.nosp@m.</span>ger@f<span style="display: none;">.nosp@m.</span>u-be<span style="display: none;">.nosp@m.</span>rlin.<span style="display: none;">.nosp@m.</span>de</a> </dd>
<dd>
Zakaria Kasmi <a href="#" onclick="location.href='mai'+'lto:'+'zka'+'sm'+'i@i'+'nf'+'.fu'+'-b'+'erl'+'in'+'.de'; return false;">zkasm<span style="display: none;">.nosp@m.</span>i@in<span style="display: none;">.nosp@m.</span>f.fu-<span style="display: none;">.nosp@m.</span>berl<span style="display: none;">.nosp@m.</span>in.de</a> * </dd></dl>

<p>Definition in file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ae58f426f79b636ded23a6aa6c6ead7b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CALC_K</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">j, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">k, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">l, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">x = <a class="code" href="twofish_8h.html#afc41493ff1b2d5f18d1b44731f44b58c">CALC_K_2</a> (k, l, k, l, 0); \</div>
<div class="line">   y = <a class="code" href="twofish_8h.html#afc41493ff1b2d5f18d1b44731f44b58c">CALC_K_2</a> (m, n, m, n, 4); \</div>
<div class="line">   y = (y &lt;&lt; 8) + (y &gt;&gt; 24);     \</div>
<div class="line">   x += y; y += x; ctx-&gt;a[j] = x; \</div>
<div class="line">   ctx-&gt;a[(j) + 1] = (y &lt;&lt; 9) + (y &gt;&gt; 23)</div>
<div class="ttc" id="twofish_8h_html_afc41493ff1b2d5f18d1b44731f44b58c"><div class="ttname"><a href="twofish_8h.html#afc41493ff1b2d5f18d1b44731f44b58c">CALC_K_2</a></div><div class="ttdeci">#define CALC_K_2(a, b, c, d, j)</div><div class="ttdoc">Macros to calculate the whitening and round subkeys. </div><div class="ttdef"><b>Definition:</b> <a href="twofish_8h_source.html#l00104">twofish.h:104</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="twofish_8h_source.html#l00110">110</a> of file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3e5982ec95cef59b942c7acb8ff12c78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CALC_K256</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">j, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">k, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">l, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">x = CALC_K256_2 (k, l, 0); \</div>
<div class="line">   y = CALC_K256_2 (m, n, 4); \</div>
<div class="line">   y = (y &lt;&lt; 8) + (y &gt;&gt; 24); \</div>
<div class="line">   x += y; y += x; ctx-&gt;a[j] = x; \</div>
<div class="line">   ctx-&gt;a[(j) + 1] = (y &lt;&lt; 9) + (y &gt;&gt; 23)</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="twofish_8h_source.html#l00123">123</a> of file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>

</div>
</div>
<a class="anchor" id="a84ffcf7d66e0b52b79790e3af4636fe6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CALC_K256_2</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">j&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><a class="code" href="twofish_8h.html#afc41493ff1b2d5f18d1b44731f44b58c">CALC_K_2</a> (q0[q1[b ^ key[(j) + 24]] ^ key[(j) + 16]], \</div>
<div class="line">             q1[q1[a ^ key[(j) + 25]] ^ key[(j) + 17]], \</div>
<div class="line">             q0[q0[a ^ key[(j) + 26]] ^ key[(j) + 18]], \</div>
<div class="line">             q1[q0[b ^ key[(j) + 27]] ^ key[(j) + 19]], j)</div>
<div class="ttc" id="twofish_8h_html_afc41493ff1b2d5f18d1b44731f44b58c"><div class="ttname"><a href="twofish_8h.html#afc41493ff1b2d5f18d1b44731f44b58c">CALC_K_2</a></div><div class="ttdeci">#define CALC_K_2(a, b, c, d, j)</div><div class="ttdoc">Macros to calculate the whitening and round subkeys. </div><div class="ttdef"><b>Definition:</b> <a href="twofish_8h_source.html#l00104">twofish.h:104</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="twofish_8h_source.html#l00117">117</a> of file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>

</div>
</div>
<a class="anchor" id="afc41493ff1b2d5f18d1b44731f44b58c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CALC_K_2</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">d, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">j&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">mds[0][q0[a ^ key[(j) + 8]] ^ key[j]]        \</div>
<div class="line">   ^ mds[1][q0[b ^ key[(j) + 9]] ^ key[(j) + 1]]  \</div>
<div class="line">   ^ mds[2][q1[c ^ key[(j) + 10]] ^ key[(j) + 2]] \</div>
<div class="line">   ^ mds[3][q1[d ^ key[(j) + 11]] ^ key[(j) + 3]]</div>
</div><!-- fragment -->
<p>Macros to calculate the whitening and round subkeys. </p>
<p>CALC_K_2 computes the last two stages of the h() function for a given index (either 2i or 2i+1). a, b, c, and d are the four bytes going into the last two stages. For 128-bit keys, this is the entire h() function and a and c are the index preprocessed through q0 and q1 respectively; for longer keys they are the output of previous stages. j is the index of the first key byte to use. CALC_K computes a pair of subkeys for 128-bit Twofish, by calling CALC_K_2 twice, doing the Psuedo-Hadamard Transform, and doing the necessary rotations. Its parameters are: a, the array to write the results into, j, the index of the first output entry, k and l, the preprocessed indices for index 2i, and m and n, the preprocessed indices for index 2i+1. CALC_K256_2 expands CALC_K_2 to handle 256-bit keys, by doing two additional lookup-and-XOR stages. The parameters a and b are the index preprocessed through q0 and q1 respectively; j is the index of the first key byte to use. CALC_K256 is identical to CALC_K but for using the CALC_K256_2 macro instead of CALC_K_2. </p>

<p>Definition at line <a class="el" href="twofish_8h_source.html#l00104">104</a> of file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8439fabb9ffa1a5aa17e17ae79aaab4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CALC_S</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">d, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">i, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">w, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">z&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">if</span> (key[i]) { \</div>
<div class="line">      tmp = poly_to_exp[key[i] - 1]; \</div>
<div class="line">      (a) ^= exp_to_poly[tmp + (w)]; \</div>
<div class="line">      (b) ^= exp_to_poly[tmp + (x)]; \</div>
<div class="line">      (c) ^= exp_to_poly[tmp + (y)]; \</div>
<div class="line">      (d) ^= exp_to_poly[tmp + (z)]; \</div>
<div class="line">   }</div>
</div><!-- fragment -->
<p>Macro to perform one column of the RS matrix multiplication. </p>
<p>The parameters a, b, c, and d are the four bytes of output; i is the index of the key bytes, and w, x, y, and z, are the column of constants from the RS matrix, preprocessed through the poly_to_exp table. </p>

<p>Definition at line <a class="el" href="twofish_8h_source.html#l00044">44</a> of file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>

</div>
</div>
<a class="anchor" id="a373ae1e6d38bd37b09ed2b1de8b62a32"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CALC_SB</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">i, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">d, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">e, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">f, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">g, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">h&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><a class="code" href="twofish_8h.html#acd680b624c9e24336e9608b967262c3a">CALC_SB_2</a> (i, a, b); <a class="code" href="twofish_8h.html#acd680b624c9e24336e9608b967262c3a">CALC_SB_2</a> ((i)+1, c, d); <a class="code" href="twofish_8h.html#acd680b624c9e24336e9608b967262c3a">\</a></div>
<div class="line"><a class="code" href="twofish_8h.html#acd680b624c9e24336e9608b967262c3a">   CALC_SB_2</a> ((i)+2, e, f); <a class="code" href="twofish_8h.html#acd680b624c9e24336e9608b967262c3a">CALC_SB_2</a> ((i)+3, g, h)</div>
<div class="ttc" id="twofish_8h_html_acd680b624c9e24336e9608b967262c3a"><div class="ttname"><a href="twofish_8h.html#acd680b624c9e24336e9608b967262c3a">CALC_SB_2</a></div><div class="ttdeci">#define CALC_SB_2(i, a, b)</div><div class="ttdoc">Macros to calculate the key-dependent S-boxes for a 128-bit key using the S vector from CALC_S...</div><div class="ttdef"><b>Definition:</b> <a href="twofish_8h_source.html#l00063">twofish.h:63</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="twofish_8h_source.html#l00069">69</a> of file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>

</div>
</div>
<a class="anchor" id="a503d9bac2e6ebe306bfc4035c0c6a068"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CALC_SB256</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">i, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">d, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">e, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">f, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">g, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">h&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">CALC_SB256_2 (i, a, b); CALC_SB256_2 ((i)+1, c, d); \</div>
<div class="line">   CALC_SB256_2 ((i)+2, e, f); CALC_SB256_2 ((i)+3, g, h)</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="twofish_8h_source.html#l00081">81</a> of file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae06b16211a5d7740c0b6a5988f904cc8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CALC_SB256_2</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">i, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">ctx-&gt;s[0][i] = mds[0][q0[q0[q1[(b) ^ sa] ^ se] ^ si] ^ sm]; \</div>
<div class="line">   ctx-&gt;s[1][i] = mds[1][q0[q1[q1[(a) ^ sb] ^ sf] ^ sj] ^ sn]; \</div>
<div class="line">   ctx-&gt;s[2][i] = mds[2][q1[q0[q0[(a) ^ sc] ^ sg] ^ sk] ^ so]; \</div>
<div class="line">   ctx-&gt;s[3][i] = mds[3][q1[q1[q0[(b) ^ sd] ^ sh] ^ sl] ^ sp];</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="twofish_8h_source.html#l00075">75</a> of file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>

</div>
</div>
<a class="anchor" id="acd680b624c9e24336e9608b967262c3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CALC_SB_2</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">i, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">ctx-&gt;s[0][i] = mds[0][q0[(a) ^ sa] ^ se]; \</div>
<div class="line">   ctx-&gt;s[1][i] = mds[1][q0[(b) ^ sb] ^ sf]; \</div>
<div class="line">   ctx-&gt;s[2][i] = mds[2][q1[(a) ^ sc] ^ sg]; \</div>
<div class="line">   ctx-&gt;s[3][i] = mds[3][q1[(b) ^ sd] ^ sh]</div>
</div><!-- fragment -->
<p>Macros to calculate the key-dependent S-boxes for a 128-bit key using the S vector from CALC_S. </p>
<p>CALC_SB_2 computes a single entry in all four S-boxes, where i is the index of the entry to compute, and a and b are the index numbers preprocessed through the q0 and q1 tables respectively. CALC_SB is simply a convenience to make the code shorter; it calls CALC_SB_2 four times with consecutive indices from i to i+3, using the remaining parameters two by two. </p>

<p>Definition at line <a class="el" href="twofish_8h_source.html#l00063">63</a> of file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5ec9a4d3e5e0feea19dea102bb028d78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DECCYCLE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">DECROUND (2 * (n) + 1, c, d, a, b); \</div>
<div class="line">   DECROUND (2 * (n), a, b, c, d)</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="twofish_8h_source.html#l00176">176</a> of file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7d7b116cbab2aa704d90edbebc826520"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DECROUND</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">d&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">x = <a class="code" href="twofish_8h.html#a0884cc2284e58fab5c6e73806c8a6147">G1</a> (a); y = G2 (b); \</div>
<div class="line">   x += y; y += x; \</div>
<div class="line">   (d) ^= y + ctx-&gt;k[2 * (n) + 1]; \</div>
<div class="line">   (d) = ((d) &gt;&gt; 1) + ((d) &lt;&lt; 31); \</div>
<div class="line">   (c) = (((c) &lt;&lt; 1)+((c) &gt;&gt; 31)); \</div>
<div class="line">   (c) ^= (x + ctx-&gt;k[2 * (n)])</div>
<div class="ttc" id="twofish_8h_html_a0884cc2284e58fab5c6e73806c8a6147"><div class="ttname"><a href="twofish_8h.html#a0884cc2284e58fab5c6e73806c8a6147">G1</a></div><div class="ttdeci">#define G1(a)</div><div class="ttdoc">Macros to compute the g() function in the encryption and decryption rounds. </div><div class="ttdef"><b>Definition:</b> <a href="twofish_8h_source.html#l00137">twofish.h:137</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="twofish_8h_source.html#l00159">159</a> of file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>

</div>
</div>
<a class="anchor" id="a05f7f296ae94465e73ebecc964f4b70b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENCCYCLE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><a class="code" href="twofish_8h.html#ab251af32ba2ecb69651d92289ddf87a5">ENCROUND</a> (2 * (n), a, b, c, d); <a class="code" href="twofish_8h.html#ab251af32ba2ecb69651d92289ddf87a5">\</a></div>
<div class="line"><a class="code" href="twofish_8h.html#ab251af32ba2ecb69651d92289ddf87a5">   ENCROUND</a> (2 * (n) + 1, c, d, a, b)</div>
<div class="ttc" id="twofish_8h_html_ab251af32ba2ecb69651d92289ddf87a5"><div class="ttname"><a href="twofish_8h.html#ab251af32ba2ecb69651d92289ddf87a5">ENCROUND</a></div><div class="ttdeci">#define ENCROUND(n, a, b, c, d)</div><div class="ttdoc">Encryption and decryption Feistel rounds. </div><div class="ttdef"><b>Definition:</b> <a href="twofish_8h_source.html#l00152">twofish.h:152</a></div></div>
</div><!-- fragment -->
<p>Encryption and decryption cycles; each one is simply two Feistel rounds with the 32-bit chunks re-ordered to simulate the "swap". </p>

<p>Definition at line <a class="el" href="twofish_8h_source.html#l00172">172</a> of file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab251af32ba2ecb69651d92289ddf87a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENCROUND</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">c, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">d&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">x = <a class="code" href="twofish_8h.html#a0884cc2284e58fab5c6e73806c8a6147">G1</a> (a); y = G2 (b); \</div>
<div class="line">   x += y; y += x + ctx-&gt;k[2 * (n) + 1]; \</div>
<div class="line">   (c) ^= x + ctx-&gt;k[2 * (n)]; \</div>
<div class="line">   (c) = ((c) &gt;&gt; 1) + ((c) &lt;&lt; 31); \</div>
<div class="line">   (d) = (((d) &lt;&lt; 1)+((d) &gt;&gt; 31)) ^ y</div>
<div class="ttc" id="twofish_8h_html_a0884cc2284e58fab5c6e73806c8a6147"><div class="ttname"><a href="twofish_8h.html#a0884cc2284e58fab5c6e73806c8a6147">G1</a></div><div class="ttdeci">#define G1(a)</div><div class="ttdoc">Macros to compute the g() function in the encryption and decryption rounds. </div><div class="ttdef"><b>Definition:</b> <a href="twofish_8h_source.html#l00137">twofish.h:137</a></div></div>
</div><!-- fragment -->
<p>Encryption and decryption Feistel rounds. </p>
<p>Each one calls the two g() macros, does the PHT, and performs the XOR and the appropriate bit rotations. The parameters are the round number (used to select subkeys), and the four 32-bit chunks of the text. </p>

<p>Definition at line <a class="el" href="twofish_8h_source.html#l00152">152</a> of file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0884cc2284e58fab5c6e73806c8a6147"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define G1</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(ctx-&gt;s[0][(a) &amp; 0xFF]) ^ (ctx-&gt;s[1][((a) &gt;&gt; 8) &amp; 0xFF]) \</div>
<div class="line">   ^ (ctx-&gt;s[2][((a) &gt;&gt; 16) &amp; 0xFF]) ^ (ctx-&gt;s[3][(a) &gt;&gt; 24])</div>
</div><!-- fragment -->
<p>Macros to compute the g() function in the encryption and decryption rounds. </p>
<p>G1 is the straight g() function; G2 includes the 8-bit rotation for the high 32-bit word. </p>

<p>Definition at line <a class="el" href="twofish_8h_source.html#l00137">137</a> of file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac979a22b5b6d21e4381d4f11f26cd802"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define G2</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(ctx-&gt;s[1][(b) &amp; 0xFF]) ^ (ctx-&gt;s[2][((b) &gt;&gt; 8) &amp; 0xFF]) \</div>
<div class="line">   ^ (ctx-&gt;s[3][((b) &gt;&gt; 16) &amp; 0xFF]) ^ (ctx-&gt;s[0][(b) &gt;&gt; 24])</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="twofish_8h_source.html#l00141">141</a> of file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>

</div>
</div>
<a class="anchor" id="a007b60ee9e74f0890abed257d6f8d58d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INPACK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">x = in[4 * (n)] ^ (in[4 * (n) + 1] &lt;&lt; 8) \</div>
<div class="line">     ^ (in[4 * (n) + 2] &lt;&lt; 16) ^ (in[4 * (n) + 3] &lt;&lt; 24) ^ ctx-&gt;w[m]</div>
</div><!-- fragment -->
<p>Macros to convert the input and output bytes into 32-bit words, and simultaneously perform the whitening step. </p>
<p>INPACK packs word number n into the variable named by x, using whitening subkey number m. OUTUNPACK unpacks word number n from the variable named by x, using whitening subkey number m. </p>

<p>Definition at line <a class="el" href="twofish_8h_source.html#l00188">188</a> of file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad3b514d7f0f2d9f0827463eb3de1f798"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OUTUNPACK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">m&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">x ^= ctx-&gt;w[m]; \</div>
<div class="line">   out[4 * (n)] = x; out[4 * (n) + 1] = x &gt;&gt; 8; \</div>
<div class="line">   out[4 * (n) + 2] = x &gt;&gt; 16; out[4 * (n) + 3] = x &gt;&gt; 24</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="twofish_8h_source.html#l00192">192</a> of file <a class="el" href="twofish_8h_source.html">twofish.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aa50b10ac974d8cd60dc30db4657e52f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int twofish_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcipher__context__t.html">cipher_context_t</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts a single block (of blockSize) using the passed context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>holds the module specific opaque data related to the key (perhaps key expansions). </td></tr>
    <tr><td class="paramname">in</td><td>a ciphertext block of blockSize </td></tr>
    <tr><td class="paramname">out</td><td>the resulting plaintext block of blockSize</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether the decryption was successful. Possible failure reasons include not calling init() </dd></dl>

</div>
</div>
<a class="anchor" id="a7459418164d80fb13f214b7ed942bc11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int twofish_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcipher__context__t.html">cipher_context_t</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts a single block (of blockSize) using the passed context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>holds the module specific opaque data related to the key (perhaps key expansions). </td></tr>
    <tr><td class="paramname">in</td><td>a plaintext block of blockSize </td></tr>
    <tr><td class="paramname">out</td><td>the resulting ciphertext block of blockSize</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether the encryption was successful. Possible failure reasons include not calling init(). </dd></dl>

</div>
</div>
<a class="anchor" id="a4ede87c36bc6c9563a83e2f003c98325"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t twofish_get_preferred_block_size </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the preferred block size that this cipher operates with. </p>
<p>It is always safe to call this function before the init() call has been made.</p>
<dl class="section return"><dt>Returns</dt><dd>the preferred block size for this cipher. In the case where the cipher operates with multiple block sizes, this will pick one particular size (deterministically). </dd></dl>

</div>
</div>
<a class="anchor" id="a9c4b7e3782e3adfcfcdca08d258f7967"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int twofish_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcipher__context__t.html">cipher_context_t</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>block_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>key_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the TwoFish-BlockCipher context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>structure to hold the opaque data from this initialization call. It should be passed to future invocations of this module which use this particular key. </td></tr>
    <tr><td class="paramname">block_size</td><td>size of the block in bytes. </td></tr>
    <tr><td class="paramname">key_size</td><td>key size in bytes </td></tr>
    <tr><td class="paramname">key</td><td>pointer to the key</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether initialization was successful. The command may be unsuccessful if the key size or blockSize are not valid. </dd></dl>

</div>
</div>
<a class="anchor" id="a9affa50785ecaa0cef11bf9c2c065d67"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int twofish_setup_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcipher__context__t.html">cipher_context_t</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>key_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up the context to use the passed key for usage with TwoFish Performs the key expansion on the real secret. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>the CipherContext-struct to save the updated key in </td></tr>
    <tr><td class="paramname">key</td><td>a pointer to the secret key </td></tr>
    <tr><td class="paramname">key_size</td><td>the length of the secret key</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a664bfa54e2065ef08486b44f38ca969a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structblock__cipher__interface__t.html">block_cipher_interface_t</a> twofish_interface</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interface to access the functions. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_a408b6d3a4a484720bc3ecfeac8947e3.html">sys</a></li><li class="navelem"><a class="el" href="dir_e9e107fc86bbb4b6a326076a6808b9f5.html">include</a></li><li class="navelem"><a class="el" href="dir_0ad69467a20205cef2b7e6370c6fd011.html">crypto</a></li><li class="navelem"><a class="el" href="twofish_8h.html">twofish.h</a></li>
    <li class="footer">Generated on Mon Jan 12 2015 15:45:17 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
